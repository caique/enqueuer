name: outterRunnableUds
runnables:
- name: runnableUds
  timeout: 5000
  startEvent:
    publisher:
      type: replaced
      onInit:
        script: publisher.type='uds';
      name: runnableUdsPublisher
      path: /tmp/inUnix.sock
      payload:

        #inner runnable
        name: runnableUds
        runnables:
        - name: innerRunnableUds
          startEvent:
            publisher:
              name: runnablePubsUds
              type: uds
              path: /tmp/loopUnix.sock
              payload: 100
          subscriptions:
          - type: uds
            name: runnableSubsUds
            path: /tmp/loopUnix.sock
            onMessageReceived:
              script: payload = Buffer.from(message).toString();
              assertions:
              - name: Works
                expected: payload
                toBeEqualTo: 100

  subscriptions:
  - type: uds
    name: subscriptionUds
    path: /tmp/outUnix.sock
    onMessageReceived:
      assertions:
      - name: Test name
        toBeDefined: message
    timeout: 5000
