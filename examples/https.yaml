runnableVersion: 01.00.00
name: Https
id: https
initialDelay: 0
runnables:
- timeout: 3000
  name: Https
  startEvent:
    publisher:
      type: https-client
      name: HttpsClient
      url: https://localhost:4430/enqueuer/idHttps?query=999
      method: I'll be reaplaced. Not because I have to. It's just an example
      prePublishing: >-
        publisher.method = 'POST';
      onMessageReceived: >-
        tester.isEqualTo('Status code', JSON.parse(message).statusCode, 200);
        tester.isEqualTo('Replaced payload', JSON.parse(message).body, 'idHttps');
      payload:
        https: works!
      headers:
        content-type: application/json
  subscriptions:
  - type: https-server
    name: HttpsServer
    endpoint: /enqueuer/:someId
    port: 4430
    method: POST
    response:
      status: 200
      payload: anyValue
    onMessageReceived: >-
      tester.isEqualTo('Params is someId', message.params.someId, 'idHttps');
      tester.isEqualTo('Query is 999', message.query.query, '999');
      tester.isEqualTo('Payload Https', JSON.parse(message.body).https, 'works!');
      subscription.response.payload = message.params.someId;
    timeout: 1000
    credentials: <<httpsCredentials>>