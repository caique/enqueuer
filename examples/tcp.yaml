runnableVersion: 01.00.00
name: runnableTcpName
id: tcp
runnables:
-
  timeout: 3000
  name: tcpFirstPart
  startEvent:
    publisher:
      type: tcp-client
      name: tcpPublisher1
      serverAddress: localhost
      port: 23070
      payload: I do not care
      persistStreamName: tcpPublisherSocket
      onMessageReceived: test['Greeting received'] = message == 'EnqueuerRocks'
      timeout: 100
  subscriptions:
  - type: tcp-server
    port: 23070
    name: tcpSubscription1
    persistStreamName: tcpSubscriptionSocket
    greetingResponse: Enqueuer
    response: Rocks
    onMessageReceived: test['I care'] = message == '"I do not care"'
    timeout: 200
-
  name: tcpSecondPart
  timeout: 3000
  startEvent:
    publisher:
      type: tcp-client
      name: tcpPublisher2
      payload: The socket is still open
      loadStreamName: tcpPublisherSocket
      onMessageReceived: test['Second message response'] = message == '{{tcpPayload}}'
  subscriptions:
  - type: tcp-server
    name: tcpSubscription2
    loadStreamName: tcpSubscriptionSocket
    response: "{{tcpPayload}}"
    onMessageReceived: test['It is still open'] = JSON.parse(message) == 'The socket is still open'
    timeout: 500