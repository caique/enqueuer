runnableVersion: 01.00.00
name: runnableTcpName
id: tcp
runnables:
-
  timeout: 3000
  name: tcpNoPart
  startEvent:
    publisher:
      type: tcp-client
      name: Any name Pub
      serverAddress: localhost
      port: 23070
      payload: Hey Jude
      onMessageReceived: tester.isEqualTo('Do not make it bad', message, 'Do not make it bad');
      timeout: 100
  subscriptions:
  - type: tcp-server
    port: 23070
    name: Any name Sub
    response: Do not make it bad
    onMessageReceived: tester.isEqualTo('Beatles Song', message, 'Hey Jude');
    timeout: 200
-
  timeout: 3000
  name: tcpFirstPart
  startEvent:
    publisher:
      type: tcp-client
      name: tcpPublisher1
      serverAddress: localhost
      port: 23070
      payload: I do not care
      persistStreamName: tcpPublisherSocket
      onMessageReceived: tester.isEqualTo('Greeting received', message, 'EnqueuerRocks');
      timeout: 100
  subscriptions:
  - type: tcp-server
    port: 23070
    name: tcpSubscription1
    persistStreamName: tcpSubscriptionSocket
    greetingResponse: Enqueuer
    response: Rocks
    onMessageReceived: tester.isEqualTo('I care', message, 'I do not care');
    timeout: 200
-
  name: tcpSecondPart
  timeout: 3000
  startEvent:
    publisher:
      type: tcp-client
      name: tcpPublisher2
      payload: The socket is still open
      loadStreamName: tcpPublisherSocket
      onMessageReceived: tester.isEqualTo('Second message response', message, '{{tcpPayload}}');
  subscriptions:
  - type: tcp-server
    name: tcpSubscription2
    loadStreamName: tcpSubscriptionSocket
    response: "{{tcpPayload}}"
    onMessageReceived: tester.isEqualTo('It is still open', message, 'The socket is still open');
    timeout: 500